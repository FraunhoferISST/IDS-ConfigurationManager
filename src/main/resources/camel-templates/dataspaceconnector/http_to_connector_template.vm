<routes xmlns="http://camel.apache.org/schema/spring">

    <route id="$routeId">

        <from uri="timer://foo?fixedRate=true&amp;period=10000"/>

        <setHeader name="CamelHttpMethod"><constant>GET</constant></setHeader>
        #if($genericEndpointAuthHeader)
            <setHeader name="Authorization"><constant>${genericEndpointAuthHeader}</constant></setHeader>
        #end
        <to uri="$startUrl"/>

        <convertBodyTo type="java.lang.String"/>
        <log message="Fetched data: ${body}"/>

        #set($lastIndex = $routeStepStartUrls.size() - 1)
        #foreach($i in [0..$lastIndex])
            #if($i > 0)
                <setHeader name="CamelHttpMethod"><constant>GET</constant></setHeader>
                <to uri="$routeStepStartUrls.get($i)"
            #end

            #if($i < $lastIndex)
                <setHeader name="CamelHttpMethod"><constant>POST</constant></setHeader>
                <to uri="$routeStepEndUrls.get($i)"
            #end
        #end

        <setHeader name="CamelHttpMethod"><constant>PUT</constant></setHeader>
        <setHeader name="Authorization"><constant>${connectorAuthHeader}</constant></setHeader>
        <to uri="$endUrl"/>

    </route>

</routes>
